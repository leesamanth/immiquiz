<!DOCTYPE html>
<html lang="en" ng-app="quizApp">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>US Citizenship Quiz - Flashcards</title>
    <meta
      name="description"
      content="Practice US citizenship test questions and answers. Review flashcards, take quizzes, and prepare for your naturalization interview with immiquiz.com."
    />
    <meta
      name="keywords"
      content="US citizenship, quiz, flashcards, naturalization, practice test, immigration, civics, questions, answers"
    />
    <meta name="author" content="immiquiz.com" />
    <meta
      property="og:title"
      content="US Citizenship Quiz - Practice Questions & Flashcards"
    />
    <meta
      property="og:description"
      content="Practice US citizenship test questions and answers. Review flashcards, take quizzes, and prepare for your naturalization interview with immiquiz.com."
    />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://immiquiz.com/" />
    <meta property="og:image" content="https://immiquiz.com/images/logo2.svg" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="US Citizenship Quiz - Practice Questions & Flashcards"
    />
    <meta
      name="twitter:description"
      content="Practice US citizenship test questions and answers. Review flashcards, take quizzes, and prepare for your naturalization interview with immiquiz.com."
    />
    <meta
      name="twitter:image"
      content="https://immiquiz.com/images/logo2.svg"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-DZ4QLE2QX7"
    ></script>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <style>
      body {
        background: #fff;
        font-family: sans-serif;
      }
      .card {
        background: #fff;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        padding: 2rem 3rem;
        margin-bottom: 2rem;
        text-align: center;
      }
      .btn {
        background: #0056b3;
        color: #fafafa;
        border: 1px solid #0056b3;
        border-radius: 8px;
        padding: 0.5rem 1.5rem;
        font-size: 1rem;
        cursor: pointer;
        transition: background 0.2s;
        margin: 0.5rem;
      }
      .answer-btn {
        background: #fafafa;
        color: #020202;
        border: 1px solid #0056b3;
        border-radius: 8px;
        padding: 0.5rem 1.5rem;
        font-size: 1rem;
        cursor: pointer;
        transition: background 0.2s;
        margin: 0.5rem;
      }
      .answer-btn.selected {
        background: #00b356;
        font-weight: bold;
      }
      .answer-btn.correct {
        background: #28a745;
      }
      .answer-btn.incorrect {
        background: #dc3545;
      }
      .submit-btn {
        background: #28a745;
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 0.5rem 1.5rem;
        font-size: 1rem;
        cursor: pointer;
        margin-top: 1rem;
      }
      .result {
        font-size: 1.2rem;
        margin-top: 1rem;
      }
    </style>
  </head>
  <body>
    <div
      class="container mx-auto px-4 py-0"
      ng-controller="FlashCardController"
    >
      <div class="header">
        <nav class="flex items-center justify-between p-4 bg-white">
          <div class="flex items-center space-x-8">
            <!-- Hamburger button for mobile, now left-aligned -->
            <button
              title="Toggle menu"
              class="md:hidden mr-2 focus:outline-none"
              ng-click="menuOpen = !menuOpen"
            >
              <svg
                class="w-8 h-8 text-gray-700"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"
                ></path>
              </svg>
            </button>
            <img
              src="images/logo2.svg"
              alt="Immigration Quiz Logo"
              class="logo"
            />
            <!-- Menu for desktop -->
            <ul class="hidden md:flex space-x-6">
              <li><a href="index.html" class="font-bold text-lg"> Home </a></li>
              <li>
                <a href="store.html" class="font-bold text-lg"> Store </a>
              </li>
              <li>
                <a href="about.html" class="font-bold text-lg"> About </a>
              </li>
            </ul>
          </div>
          <!-- Mobile drawer -->
          <div
            ng-show="menuOpen"
            class="md:hidden absolute top-16 left-0 w-full bg-white shadow-lg z-50"
          >
            <ul class="flex flex-col items-center py-4 space-y-2">
              <li>
                <a
                  href="index.html"
                  class="font-bold text-lg block w-full px-4 py-2"
                >
                  Home
                </a>
              </li>
              <li>
                <a
                  href="store.html"
                  class="font-bold text-lg block w-full px-4 py-2"
                >
                  Store
                </a>
              </li>
              <li>
                <a
                  href="about.html"
                  class="font-bold text-lg block w-full px-4 py-2"
                >
                  About
                </a>
              </li>
            </ul>
          </div>
        </nav>
      </div>
      <div class="mx-auto px-4 py-8 flex flex-col md:flex-row">
        <main class="flex-1 min-w-0">
          <div class="container mx-auto px-4 py-8">
            <div class="flex justify-end mb-4">
              <label class="flex items-center space-x-2">
                <input
                  type="checkbox"
                  ng-model="readOutEnabled"
                  ng-change="onReadOutToggle()"
                />
                <span class="text-sm">Read question out loud</span>
              </label>
            </div>
          </div>
          <div
            class="card drop-shadow-amber-50 border-2 border-amber-200 rounded-3xl"
          >
            <div class="question" ng-bind="currentQuestion.question"></div>
            <div class="options">
              <div class="italic text-gray-500" ng-if="!showAnswers">
                practice saying the answer out loud
              </div>
              <div ng-if="(requiresAdditionalInput)">
                <label for="stateSelect" class="block mb-2 font-semibold">
                  Select your state:
                </label>
                <select
                  id="stateSelect"
                  ng-model="selection.selectedState"
                  ng-options="state.abbreviation as state.name for state in states track by state.abbreviation"
                  ng-change="onStateSelectionChange()"
                  class="border rounded px-3 py-2 mb-4 w-full"
                ></select>
              </div>
              <div ng-if="!showAnswers">
                <div>
                  <button class="btn btn-primary" ng-click="showAnswersFn()">
                    Show Answers
                  </button>
                </div>
              </div>
            </div>
            <div ng-if="showAnswers">
              <ul class="list-none p-0 m-0">
                <li
                  class="border-2 border-b-green-900 rounded-lg p-2 m-1 w-full"
                  ng-repeat="option in currentOptions"
                >
                  {{ option }}
                </li>
              </ul>
              <div ng-if="currentQuestion.disclaimer">
                <p class="text-sm text-gray-500">
                  {{ currentQuestion.disclaimer }}
                </p>
              </div>
            </div>
          </div>
          <div class="grid place-items-end">
            <button class="btn btn-primary" ng-click="nextQuestion()">
              Next Question
            </button>
          </div>
        </main>
        <aside
          class="w-full md:w-1/3 md:pl-8 mt-8 md:mt-0 max-h-160 overflow-y-scroll"
        ></aside>
      </div>
    </div>
    <script>
      angular
        .module("quizApp", [])
        .controller("FlashCardController", function ($scope, $http, $timeout) {
          $scope.questions = [];
          $scope.flashCardQuestions = [];
          $scope.currentIndex = 0;
          $scope.currentQuestion = null;
          $scope.currentOptions = [];
          $scope.selectedOptions = [];
          $scope.showAnswers = false;
          $scope.requiresAdditionalInput = false;
          $scope.flashCardsFinished = false;
          $scope.score = 0;
          $scope.answeredQuestions = [];
          $scope.readOutEnabled = false;
          $scope.totalQuestions = 100;
          $scope.selection = { selectedState: null };
          $scope.states = [];

          $scope.onStateSelectionChange = function () {
            var selectedChoice = $scope.selection.selectedState;
            var selectedStateName = $scope.states.find(function (s) {
              return s.abbreviation === selectedChoice;
            })?.name;
            var url = $scope.currentQuestion.answerSource;
            if (url && selectedChoice && selectedChoice !== "-") {
              var finalUrl = url.replace("{state}", selectedChoice);
              $http.get(finalUrl).then(
                function (response) {
                  if (
                    response.data &&
                    response.data.members &&
                    response.data.members.length > 0
                  ) {
                    $scope.currentOptions = [];
                    response.data.members.forEach(function (m) {
                      if (m.terms.item) {
                        m.terms.item.forEach(function (t) {
                          if (
                            t.chamber &&
                            t.chamber === $scope.currentQuestion.chamber
                          ) {
                            if (
                              !t.endYear ||
                              t.endYear >= new Date().getFullYear()
                            ) {
                              $scope.currentOptions.push(m.name);
                            }
                          }
                        });
                      }
                    });
                    $scope.showAnswers = true;
                    var membersList = [];
                    $scope.currentOptions.forEach(function (member) {
                      membersList.push(member.replace(/,/g, " "));
                    });
                    var msg =
                      "Members of the " +
                      $scope.currentQuestion.chamber +
                      " from " +
                      selectedStateName +
                      " are  , ," +
                      membersList.join(", , ");
                    if ($scope.readOutEnabled) {
                      $timeout(function () {
                        speak(msg);
                      }, 200);
                    }
                  } else {
                    alert("No answer found for the selected state.");
                  }
                },
                function (error) {
                  alert("Error loading answer data.");
                }
              );
            } else {
              $scope.showAnswers = true;
              $scope.currentOptions = $scope.currentQuestion.answers.slice(); //copy array
            }
          };

          $scope.onReadOutToggle = function () {
            if (
              $scope.readOutEnabled &&
              $scope.currentQuestion &&
              $scope.currentQuestion.question
            ) {
              $timeout(function () {
                speak($scope.currentQuestion.question);
              }, 100);
            } else {
              if (window.speechSynthesis) window.speechSynthesis.cancel();
            }
          };

          $http.get("questions.json").then(
            function (response) {
              // Flatten all questions from all sections
              var allQuestions = [];
              if (Array.isArray(response.data)) {
                response.data.forEach(function (q) {
                  allQuestions.push(q);
                });
                $scope.questions = allQuestions;
                //start flashcards
                startFlashcards();
              } else {
                $scope.questions = [];
                $scope.quizFinished = true;
                alert("Error: questions.json is not in the expected format.");
              }
            },
            function (error) {
              $scope.questions = [];
              $scope.quizFinished = true;
              alert("Error loading questions.json");
            }
          );

          $http.get("states.json").then(
            function (response) {
              $scope.states = response.data;
              // Add a default "prompt" option to the beginning of the array
              $scope.states.unshift({
                name: "-- Choose State --",
                abbreviation: "-",
              });
              // Set the model to the default value
              $scope.selection.selectedState = "-";
              if (!$scope.states || $scope.states.length === 0) {
                console.log("No states available");
              }
            },
            function (error) {
              $scope.states = [];
            }
          );

          function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
              const j = Math.floor(Math.random() * (i + 1));
              [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
          }

          function speak(text) {
            if ("speechSynthesis" in window) {
              var voices = window.speechSynthesis.getVoices();
              var utter = new SpeechSynthesisUtterance(text);
              // Alternate between male and female voices
              if (!$scope.voiceToggle) $scope.voiceToggle = false;
              var genderVoices = voices.filter(function (v) {
                return v.lang.startsWith("en") && (v.gender ? true : true);
              });
              var femaleVoice = genderVoices.find(function (v) {
                return (
                  v.name.toLowerCase().includes("female") ||
                  v.voiceURI.toLowerCase().includes("female") ||
                  v.name.toLowerCase().includes("woman")
                );
              });
              var maleVoice = genderVoices.find(function (v) {
                return (
                  v.name.toLowerCase().includes("male") ||
                  v.voiceURI.toLowerCase().includes("male") ||
                  v.name.toLowerCase().includes("man")
                );
              });
              if ($scope.voiceToggle && femaleVoice) {
                utter.voice = femaleVoice;
              } else if (!$scope.voiceToggle && maleVoice) {
                utter.voice = maleVoice;
              }
              $scope.voiceToggle = !$scope.voiceToggle;
              window.speechSynthesis.cancel();
              window.speechSynthesis.speak(utter);
            }
          }

          function startFlashcards() {
            //clear this.
            $scope.questions = $scope.questions.filter(function (q) {
              return q.requiresState === true;
            });
            $scope.totalQuestions = $scope.questions.length;
            //clear this.
            $scope.flashCardQuestions = shuffle($scope.questions).slice(
              0,
              $scope.totalQuestions
            );
            $scope.currentIndex = 0;
            $scope.flashCardsFinished = false;
            //call function to display question
            loadQuestion();
          }

          function loadQuestion() {
            if ($scope.currentIndex < $scope.flashCardQuestions.length) {
              $scope.selection.selectedState = "-";
              $scope.requiresAdditionalInput = false;
              $scope.currentQuestion =
                $scope.flashCardQuestions[$scope.currentIndex];
              $scope.selectedOptions = [];
              $scope.showAnswers = false;
              // Prepare options
              var opts = $scope.currentQuestion.answers.slice();
              // Remove duplicates
              $scope.currentOptions = shuffle(Array.from(new Set(opts)));

              var msg = $scope.currentQuestion.question;

              if ($scope.readOutEnabled) {
                $timeout(function () {
                  speak(msg);
                }, 100);
              }
            } else {
              $scope.flashCardsFinished = true;
            }
          }

          $scope.showAnswersFn = function () {
            $scope.selection.selectedState = "-";
            if (
              !$scope.currentQuestion.requiresState &&
              $scope.readOutEnabled &&
              $scope.currentOptions &&
              $scope.currentOptions.length
            ) {
              $scope.showAnswers = true;
              var msg = "";
              if ($scope.currentOptions.length > 1) {
                msg =
                  "There are " +
                  $scope.currentOptions.length +
                  " possible answers. ";
              }
              var answersText = $scope.currentOptions.join(". ");
              if ($scope.currentQuestion.disclaimer)
                answersText +=
                  ". Disclaimer - " + $scope.currentQuestion.disclaimer + ". ";
              speak(msg + answersText);
            } else {
              $scope.showAnswers = false;
              $scope.requiresAdditionalInput = true;
              if ($scope.readOutEnabled) {
                $timeout(function () {
                  speak("Please select your state.");
                }, 200);
              }
            }
          };

          $scope.nextQuestion = function () {
            if ($scope.currentIndex < $scope.flashCardQuestions.length - 1) {
              $scope.currentIndex++;
              loadQuestion();
            } else {
              $scope.flashCardsFinished = true;
            }
          };
        });
    </script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-DZ4QLE2QX7");
    </script>
  </body>
</html>
